<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Your Cart - The Lit Lounge</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <header class="site-header">
    <nav class="nav container">
      <a class="brand" href="index.html">The Lit Lounge</a>
      <div class="nav-links">
        <a href="index.html">Home</a>
        <a href="browse.html">Browse</a>
        <a href="about.html">About</a>
        <a href="cart.html" aria-current="page">Cart</a>
        <a href="contact.html">Contact</a>
      </div>
    </nav>
  </header>

  <main class="container">
    <section class="section">
      <div class="section-head">
        <h1 class="page-title">Your Cart</h1>
        <p class="muted">Update quantities or remove items before checkout.</p>
      </div>

      <!-- Empty state -->
      <div id="emptyCart" class="empty-state" style="display:none;">
        <h2>Your cart is empty</h2>
        <p class="muted">Browse the catalog and add a few books to get started.</p>
        <a class="btn primary" href="browse.html">Browse Books</a>
      </div>

      <!-- Cart layout -->
      <div id="cartLayout" class="cart-layout" style="display:none;">
        <div class="cart-panel">
          <div class="table-wrap">
            <table class="cart-table">
              <thead>
                <tr>
                  <th>Book</th>
                  <th class="num">Price</th>
                  <th class="num">Qty</th>
                  <th class="num">Subtotal</th>
                  <th class="num">Remove</th>
                </tr>
              </thead>
              <tbody id="cartBody"></tbody>
            </table>
          </div>
        </div>

        <aside class="summary-panel">
          <h2 class="summary-title">Order Summary</h2>
          <div id="cartTotals" class="summary-lines"></div>
          <button class="btn primary summary-btn" onclick="fakeCheckout()">Checkout</button>
          <p class="muted tiny">Demo checkout (no payments processed).</p>
        </aside>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container">
      <p>&copy; 2025 The Lit Lounge. All rights reserved.</p>
    </div>
  </footer>

  <script>
    function money(n){ return `$${n.toFixed(2)}`; }

    function loadCart() {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      const tbody = document.getElementById('cartBody');
      const totalsDiv = document.getElementById('cartTotals');

      const empty = document.getElementById('emptyCart');
      const layout = document.getElementById('cartLayout');

      tbody.innerHTML = '';
      totalsDiv.innerHTML = '';

      if (cart.length === 0) {
        empty.style.display = 'block';
        layout.style.display = 'none';
        return;
      }

      empty.style.display = 'none';
      layout.style.display = 'grid';

      let subtotal = 0;

      cart.forEach((item, index) => {
        const itemSubtotal = item.price * item.qty;
        subtotal += itemSubtotal;

        const row = document.createElement('tr');
        row.innerHTML = `
          <td>
            <div class="cart-item">
              <div class="cart-item-title">${item.title}</div>
              <div class="muted tiny">${money(item.price)} each</div>
            </div>
          </td>
          <td class="num">${money(item.price)}</td>
          <td class="num">
            <input class="qty-input" type="number" value="${item.qty}" min="1"
              onchange="updateQty(${index}, this.value)">
          </td>
          <td class="num">${money(itemSubtotal)}</td>
          <td class="num">
            <button class="btn small ghost" onclick="removeItem(${index})">Remove</button>
          </td>
        `;
        tbody.appendChild(row);
      });

      const taxRate = 0.08;
      const tax = subtotal * taxRate;
      const shipping = subtotal > 0 ? 5.00 : 0;
      const total = subtotal + tax + shipping;

      totalsDiv.innerHTML = `
        <div class="summary-row"><span>Subtotal</span><span>${money(subtotal)}</span></div>
        <div class="summary-row"><span>Tax (8%)</span><span>${money(tax)}</span></div>
        <div class="summary-row"><span>Shipping</span><span>${money(shipping)}</span></div>
        <div class="summary-row total"><span>Total</span><span>${money(total)}</span></div>
      `;
    }

    function removeItem(index) {
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      cart.splice(index, 1);
      localStorage.setItem('cart', JSON.stringify(cart));
      loadCart();
    }

    function updateQty(index, newQty) {
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      const qty = Math.max(1, parseInt(newQty || "1", 10));
      cart[index].qty = qty;
      localStorage.setItem('cart', JSON.stringify(cart));
      loadCart();
    }

    function fakeCheckout(){
      alert("Demo checkout â€” no payment processing enabled.");
    }

    window.onload = loadCart;
  </script>
</body>
</html>
